<tool id="simid" name="simid" version="1.0">
<stdio>
<exit_code range="1:" />
</stdio>
<description>Supports the initial step of workflow of fluxomic analysis of stable isotope (13C) propagation in cellular metabolites. CDF2MID evaluates the peaks of mass isotopomer distribution (MID) for metabolites of interest, making them ready for the next step of the workflow: correction for natural isotope occurrence.</description>
<command><![CDATA[
mkdir cdfdata;
#for $cdf in $cdf_files
echo 'Linking file $cdf to cdfdata/$cdf.name';
ln -s $cdf 'cdfdata/$cdf.name';
#end for
runsimid.R -i "$metadata" -o "$outputdir" -z cdfdata;
rm -rf cdfdata
]]></command>
<inputs>
	<param type="data" name="metadata" format="txt" label="Metadata file in R format" />
	<param type="data" name="cdf_files" multiple="true" format="netcdf" />
</inputs>
<outputs>
    <data name="outputExchange" format="csv" label="Isotopologues file"/>
</outputs>
<help>
==============
simid
==============

Version: 1.0

-----------------
Short description
-----------------

- **CDF2MID** is an R-program that reads netCDF files, created by a mass spectrometer, and extracts and primarily corrects the mass spectra of 13C-labeled metabolites using a short description of data. It provides the evaluated spectra and supporting information in a file exchangeable with a database Metabolights (further called as exchange file) thus preparing the data for uploading to this database. It supports the initial step of workflow of fluxomic analysis of stable isotope (13C) propagation in cellular metabolites, making them ready for the next step of the workflow: correction for natural isotope occurrence.

-----------
Description
-----------

SIMID is a computer program, written in R, designed to read netCDF files generated by mass spectrometer in SIM (selected ion monitoring) mode, containing time courses of m/z spectra registered for various metabolites. It evaluates the peaks of mass isotopomer distribution (MID) of metabolites, thus preparing the data to further correction for natural isotope occurrence. The github repository "https://github.com/seliv55/simid" is used to create the docker image.

SIMID reads the CDF files presented in the working directory, finds the spectra corresponding to specific metabolites of interest; corrects baseline for each peak in the spectra; choses the time points where the distribution of peaks is less contaminated by other compounds and thus is the most representative of the real distribution of mass isotopomers in the analyzed metabolite; evaluates this distribution, and saves it in files readable by MIDcor, a program, which performs the next step of fluxomic analysis, i.e. correction of the SIMID spectra for natural isotope occurrence. The functions performed by SIMID are similar to those of RaMID (https://github.com/seliv55/ramid). However, there is a difference in the input data for both programs. Ramid uses the description of metabolites of interest provided in the format of the table, exchangeable with the database Metabolights. Therefore it designed for primary analysis of mass spectra already presented in this database and downloaded from it. Alternatively, SIMID is created for the initial step of analysis of recently obtained data that are not uploaded to Metabolights yet. The output SIMID provides in the format of the table, exchangeable with Metabolights, and also in a human-readable form. The difference in the format of input data description also determines an essential difference in the code. Input tables for RaMID provide the direct references to the CDF files corresponding to the information written in each line of the table. The input information for SIMID does not contain such a reference. The absence of reference simplifies the data description for the user but makes the code more complicated: it searches the desired spectra one by one through all the provided CDF files.
------------
Key features
------------

- Primary processing of 13C mass isotopomer data obtained with GCMS: evaluation of mass spectra for the metabolites of interest.

-------------
Functionality
-------------

- Preprocessing of raw data
- Initiation of workflows

----------
Approaches
----------

- Isotopic Labeling Analysis / 13C

---------------------
Instrument Data Types
---------------------

- MS

-------------
Data Analysis
-------------

Each netCDF file contains a time course of mass spectra of metabolites registered in one injection to a gas chromatograph/mass spectrometer. All the files corresponding a whole experiment (or several experiments) are provided in a single folder. An additional information should be provided in a text file in maximally simplified for manual description format. The output information provided in a file exchangeable with Metabolights database in the format of csv table, containing columns entitled as: 
"Raw Data filename", "cells", "tracer molecule", "labelled positions", "abundance", "injection", "Replicate", "Incubation time", "Metabolite name", "CHEBI identifier", "fragment position to the parent molecule", "Empirical formula derivatized molecule/fragment", "retention(min)", "m/z monitored", "signal intensity", "isotopologue", "isotologue relative concentration".

*CDF2MID* reads one by one the provided CDF files and extracts mass spectra of the metabolites of interest specified in the input file of data description, identifying them by the indicated region of m/z and retention time, corrects baseline, and writes the obtained data in the the exchange file in the column entitled "signal intensity". The “R” code of CDF2MID together with a description of its using (README.md) can be downloaded from https://github.com/seliv55/cdf2mid.

This tool is adapted for using data contained in the database Metabolights, provided in the format accepted for the exchange file. Then it supplies the Metabolights with more data prepared for the next step of analysis peformed by MIDcor. The latter is a program, which corrects the RaMID spectra for natural isotope occurrence, which is necessary to perform a fluxomic analysis, for H+ loss produced by electron impact, and peaks overlapping.
	
-------------------------------------
 The format of input data description
-------------------------------------

- The input data description file (here "sw620") contains the additional information prepared by the data provider that is necessary for the analysis and for the output table to write in the format accepted as exchangeable with the Metabolights database. It contains the following columns: 
(i) names of metabolites of interest, which spectra should be extracted from the provided CDF files; 
(ii) retention time (RT); 
(iii) m/z value of the lightest isotopomer (mz0) corresponding to the resolved derivatized fragment of metabolite of interest; 
(iv) position of the resolved carbon fragment in the parent molecule; 
(v) chemical formula of the derivatized compound containing the given fragment; 
(vi) m/z value of the lightest isotopomer corresponding to another fragment of the same metabolite (control).

----------------------------------
The names of CDF files provided
----------------------------------

- The input file (here "sw620") provides the general informarion used by the program. Moreover, the names of CDF files should contain a specific information referred to each separate measurement. Here is an example of filename: "SW620_6h_12Glc_R1_PIM_SIM_01.CDF". SW620 is the type of analyzed cells 6h is the time of incubation 12Glc indicates the artificially labeled substrate applied. R1 is a number of biological replicate 01 is a number of ingection to MS machine from the same biological replicate

Based on this information and that extracted from the CDF files presented in the working directory siMID evaluates the mass spectra of the metabolites listed in "metdata", and saves it in tables accepted as exchangeable with Metabolights database.


</help>
</tool>
